diff -urN package/proftpd.ORIG/proftpd-1.3.4b-003-vroot_user_expansion.patch package/proftpd/proftpd-1.3.4b-003-vroot_user_expansion.patch
--- package/proftpd.ORIG/proftpd-1.3.4b-003-vroot_user_expansion.patch	1969-12-31 16:00:00.000000000 -0800
+++ package/proftpd/proftpd-1.3.4b-003-vroot_user_expansion.patch	2013-02-21 15:26:03.587379190 -0800
@@ -0,0 +1,25 @@
+--- proftpd-1.3.4b/contrib/mod_vroot.c.ORIG	2013-02-21 13:38:26.348706732 -0800
++++ proftpd-1.3.4b/contrib/mod_vroot.c	2013-02-21 15:24:21.262353537 -0800
+@@ -373,10 +373,20 @@
+      */
+ 
+     memset(src_path, '\0', sizeof(src_path));
+-    sstrncpy(src_path, c->argv[0], sizeof(src_path)-1);
++    ptr = c->argv[0];
++
++    /* Check for any expandable variables. */
++    ptr = path_subst_uservar(tmp_pool, &ptr);
++
++    sstrncpy(src_path, ptr, sizeof(src_path)-1);
+     vroot_clean_path(src_path);
+ 
+-    ptr = dir_best_path(tmp_pool, c->argv[1]);
++    ptr = c->argv[1];
++
++    /* Check for any expandable variables. */
++    ptr = path_subst_uservar(tmp_pool, &ptr);
++
++    ptr = dir_best_path(tmp_pool, ptr);
+     vroot_lookup_path(NULL, dst_path, sizeof(dst_path)-1, ptr,
+       VROOT_LOOKUP_FL_NO_ALIASES, NULL);
+ 
